{"version":3,"sources":["webpack://betterFetcher/webpack/universalModuleDefinition","webpack://betterFetcher/webpack/bootstrap","webpack://betterFetcher/./src/better-fetcher.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","cacheName","defaultTimeout","defaultCredentials","defaultHeaders","GET","POST","PUT","DELETE","ALL","defaultDataType","networkDataReceived","timeoutFetch","url","options","timeoutPromise","timeout","fetch","init","then","response","ok","prepareData","data","type","obj","checkDefaults","JSON","stringify","headers","Content-type","body","method","changeCredentials","header","keys","forEach","length","changeHeaders","handleResponse","Promise","resolve","reject","handleCacheResponse","callback","dataType","handleResponseData","handleCachedResponse","Function","json","blob","arrayBuffer","formData","text","ms","promise","timeoutId","setTimeout","Error","res","clearTimeout","err","setCacheName","getCacheName","setDefaultTimeout","getDefaultTimeout","setDefaultCredentialsPolicy","getDefaultCredentialsPolicy","setDefaultHeaders","getDefaultHeaders","setDefaultDataType","getDefaultDataType","networkCall","useCache","console","log","handleNetworkResponse","matchAll","caches","match","catch","error","checkCaches","post","put","delete"],"mappings":"CAAA,SAAAA,EAAAC,GACA,iBAAAC,SAAA,iBAAAC,OACAA,OAAAD,QAAAD,IACA,mBAAAG,eAAAC,IACAD,OAAA,mBAAAH,GACA,iBAAAC,QACAA,QAAA,cAAAD,IAEAD,EAAA,cAAAC,IARA,CASCK,OAAA,WACD,mBCTA,IAAAC,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAP,QAGA,IAAAC,EAAAI,EAAAE,GAAA,CACAC,EAAAD,EACAE,GAAA,EACAT,QAAA,IAUA,OANAU,EAAAH,GAAAI,KAAAV,EAAAD,QAAAC,IAAAD,QAAAM,GAGAL,EAAAQ,GAAA,EAGAR,EAAAD,QA0DA,OArDAM,EAAAM,EAAAF,EAGAJ,EAAAO,EAAAR,EAGAC,EAAAQ,EAAA,SAAAd,EAAAe,EAAAC,GACAV,EAAAW,EAAAjB,EAAAe,IACAG,OAAAC,eAAAnB,EAAAe,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CV,EAAAgB,EAAA,SAAAtB,GACA,oBAAAuB,eAAAC,aACAN,OAAAC,eAAAnB,EAAAuB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAnB,EAAA,cAAiDyB,OAAA,KAQjDnB,EAAAoB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAnB,EAAAmB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFAxB,EAAAgB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAnB,EAAAQ,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAvB,EAAA2B,EAAA,SAAAhC,GACA,IAAAe,EAAAf,KAAA2B,WACA,WAA2B,OAAA3B,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAK,EAAAQ,EAAAE,EAAA,IAAAA,GACAA,GAIAV,EAAAW,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD7B,EAAAgC,EAAA,GAIAhC,IAAAiC,EAAA,mBClFAvC,EAAAC,EAAAD,QAAA,OACAwC,EAAA,GACAC,EAAA,IACAC,EAAA,cACAC,EAAA,CACAC,IAAA,GACAC,KAAA,GACAC,IAAA,GACAC,OAAA,GACAC,IAAA,IAEAC,EAAA,GACAC,GAAA,EAwGA,SAAAC,EAAAC,EAAAC,GACA,OAAAC,EAAAD,EAAAE,SAAAd,EAAAe,MAAAJ,EAAAC,EAAAI,OAAAC,KAAA,SAAAC,GACA,GAAAA,EAAAC,GAGA,OAAAD,EAFA,MAAAA,IA+BA,SAAAE,EAAAC,EAAAT,EAAAU,GA0HA,IAAAC,EAjHA,OARAX,EAAAY,EAAAZ,EAAAU,IAyHAC,EAxHAF,KAyHA5C,OAAA8C,KAxHAF,EAAAI,KAAAC,UAAAL,GACAT,EAAAI,KAAAW,QAAA,CACAC,eAAA,qBAGAhB,EAAAI,KAAAa,KAAAR,EACAT,EAGA,SAAAY,EAAAZ,EAAAU,GAOA,OANAV,MAAA,IACAA,EAAAI,OAAAJ,EAAAI,KAAA,IACAJ,EAAAI,KAAAc,SAAAlB,EAAAI,KAAAc,OAAAR,GACAV,EAAAI,KAAAf,qBAAAW,EAoBA,SAAAA,GAEA,OADAA,EAAAI,KAAAf,qBACAW,EAtBAmB,CAAAnB,IACAA,EAKA,SAAAA,EAAAU,GACA,MAAAU,EAAA,GACAvD,OAAAwD,KAAA/B,EAAAK,KAAA2B,QAAA5C,GAAA0C,EAAA1C,GAAAY,EAAAK,IAAAjB,IACAb,OAAAwD,KAAA/B,EAAAoB,IAAAY,QAAA5C,GAAA0C,EAAA1C,GAAAY,EAAAoB,GAAAhC,IACAsB,EAAAI,KAAAgB,QACAvD,OAAAwD,KAAArB,EAAAI,KAAAgB,QAAAE,QAAA5C,GAAA0C,EAAA1C,GAAAsB,EAAAI,KAAAgB,OAAA1C,IAEAb,OAAAwD,KAAAD,GAAAG,OAAA,IACAvB,EAAAI,KAAAW,QAAAK,GAGA,OAAApB,EAhBAwB,CAAAxB,EAAAU,GAwBA,SAAAe,EAAAnB,GACA,GAAAA,EAIE,IAAAA,EAAAC,GAGF,OAAAD,EAFA,MAAAA,EAJA,WAAAoB,QAAA,SAAAC,EAAAC,GACAA,EAAA,iBA2BA,SAAAC,EAAAvB,EAAAN,EAAA8B,GAEA,IAAAjC,EAGA,OAAAG,EAAA+B,SAIAC,EAAA1B,EAAAN,GAAAK,KAAA,SAAAI,GACAT,EAAAiC,gCAAAC,SAAAlC,EAAAiC,qBAAAxB,GACAqB,EAAArB,UALAT,EAAAiC,gCAAAC,SAAAlC,EAAAiC,qBAAA3B,GACAwB,EAAAxB,IASA,SAAA0B,EAAA1B,EAAAN,GACA,OAAAA,EAAA+B,UACA,WACA,OAAAzB,EAAA6B,OACA,WACA,OAAA7B,EAAA8B,OACA,kBACA,OAAA9B,EAAA+B,cACA,eACA,OAAA/B,EAAAgC,WACA,WACA,OAAAhC,EAAAiC,OACA,QACA,OAAAjC,GAIA,SAAAL,EAAAuC,EAAAC,GACA,WAAAf,QAAA,CAAAC,EAAAC,KACA,MAAAc,EAAAC,WAAA,KACAf,EAAA,IAAAgB,MAAA,qBACGJ,GACHC,EAAApC,KACAwC,IACAC,aAAAJ,GACAf,EAAAkB,IAEAE,IACAD,aAAAJ,GACAd,EAAAmB,OA5PApG,EAAAqG,aAAA,SAAAtF,GACAyB,EAAAzB,GAGAf,EAAAsG,aAAA,WACA,OAAA9D,GAGAxC,EAAAuG,kBAAA,SAAAV,GACApD,EAAAoD,GAGA7F,EAAAwG,kBAAA,WACA,OAAA/D,GAGAzC,EAAAyG,4BAAA,SAAA9E,GACAe,EAAAf,GAGA3B,EAAA0G,4BAAA,WACA,OAAAhE,GAGA1C,EAAA2G,kBAAA,SAAAvC,EAAAL,GACApB,EAAAoB,GAAAK,GAGApE,EAAA4G,kBAAA,SAAA7C,GACA,OAAApB,EAAAoB,IAGA/D,EAAA6G,mBAAA,SAAA9C,GACAd,EAAAc,GAGA/D,EAAA8G,mBAAA,WACA,OAAA7D,GAkBAjD,EAAAqB,IAAA,SAAA+B,EAAAC,EAAA,GAAwC8B,GACxCjC,GAAA,EAMA,IAAA6D,EAAAzD,GAHAD,EAAAY,EAAAZ,EAAA,QAGAE,SAAAd,EAAAe,MAAAJ,EAAAC,EAAAI,OACAC,KAAAoB,GACApB,KAAA,SAAAC,GAEA,OADAT,GAAA,EA4HA,SAAAS,EAAAN,EAAA8B,GACA,IAAA9B,EAAA2D,SACA,OAAA3B,EAAA1B,EAAAN,GAEAA,EAAA+B,UAIA6B,QAAAC,IAAA7D,EAAA+B,UACAC,EAAA1B,EAAAN,GAAAK,KAAA,SAAAI,GACAZ,GAAA,EACAG,EAAA8D,iCAAA5B,SAAAlC,EAAA8D,sBAAArD,GACAqB,EAAArB,MAPAT,EAAA8D,iCAAA5B,SAAAlC,EAAA8D,sBAAAxD,GACAwB,EAAAxB,GAjIAwD,CAAAxD,EAAAN,EAAA8B,KAMA,OAFA9B,EAAA2D,UA0CA,SAAA5D,EAAAC,EAAA8B,GACA9B,EAAA+D,SAWAC,OACAC,MAAAlE,GACAM,KAAAoB,GACApB,KAAA,SAAAC,GACA,OAAAuB,EAAAvB,EAAAN,EAAA8B,KAEAoC,MAAA,SAAAC,GACAP,QAAAC,IAAAM,KA7DAC,CAAArE,EAAAC,EAAA8B,GAEA4B,GAQA/G,EAAA0H,KAAA,SAAAtE,EAAAU,EAAAT,GAGA,OAAAF,EAAAC,EAFAC,EAAAQ,EAAAC,EAAAT,EAAA,UASArD,EAAA2H,IAAA,SAAAvE,EAAAU,EAAAT,GAGA,OAAAF,EAAAC,EAFAC,EAAAQ,EAAAC,EAAAT,EAAA,SAKArD,EAAA4H,OAAA,SAAAxE,EAAAC,GAGA,OAAAF,EAAAC,EAFAC,EAAAY,EAAAZ,EAAA","file":"betterFetcher.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"betterFetcher\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"betterFetcher\"] = factory();\n\telse\n\t\troot[\"betterFetcher\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","var exports = (module.exports = {});\nvar cacheName = '';\nvar defaultTimeout = 5000;\nvar defaultCredentials = 'same-origin';\nvar defaultHeaders = {\n\tGET: {},\n\tPOST: {},\n\tPUT: {},\n\tDELETE: {},\n\tALL: {}\n};\nvar defaultDataType = '';\nvar networkDataReceived = false;\n\nexports.setCacheName = function(name) {\n\tcacheName = name;\n};\n\nexports.getCacheName = function() {\n\treturn cacheName;\n};\n\nexports.setDefaultTimeout = function(ms) {\n\tdefaultTimeout = ms;\n};\n\nexports.getDefaultTimeout = function() {\n\treturn defaultTimeout;\n};\n\nexports.setDefaultCredentialsPolicy = function(mode) {\n\tdefaultCredentials = mode;\n};\n\nexports.getDefaultCredentialsPolicy = function() {\n\treturn defaultCredentials;\n};\n\nexports.setDefaultHeaders = function(headers, type) {\n\tdefaultHeaders[type] = headers;\n};\n\nexports.getDefaultHeaders = function(type) {\n\treturn defaultHeaders[type];\n};\n\nexports.setDefaultDataType = function(type) {\n\tdefaultDataType = type;\n};\n\nexports.getDefaultDataType = function() {\n\treturn defaultDataType;\n};\n\n/*\nurl:\nSet to the destination that you want to fetch data from.\noptions:\nmatchAll - Set flag true to match all responses in the cache instead of first hit\ndataType - Types include: \"json\", \"blob\", \"formData\", \"arrayBuffer\", \"text\", \"raw\"\ninit - Pass through init object to fetch call manually.\ntimeout - timeout (in ms) to set on the api call.\nhandleCachedResponse - Manually specify a function to be used only for returned cached data.\nhandleNetworkResponse - Manually specify a function to be used only for returned network data.\nuseCache - Flag to check cache and return \ncallback:\nThe function to be called with data as it is received. Expect this function to be called multiple times given that it will likely first be called with cache data and then called with updated network data. \nDo not rely on it being called twice however given that it won't be called a second time if network data returns first or cache data does not exist\n*/\nexports.get = function(url, options = {}, callback) {\n\tnetworkDataReceived = false;\n\tvar cacheResponse = {};\n\n\toptions = checkDefaults(options, 'GET');\n\n\t// fetch fresh data\n\tvar networkCall = timeoutPromise(options.timeout || defaultTimeout, fetch(url, options.init))\n\t\t.then(handleResponse)\n\t\t.then(function(response) {\n\t\t\tnetworkDataReceived = true;\n\t\t\treturn handleNetworkResponse(response, options, callback);\n\t\t});\n\n\t// fetch cached data\n\tif (options.useCache) checkCaches(url, options, callback);\n\n\treturn networkCall;\n};\n\n/*\noptions:\ninit - init to pass through to fetch\nTakes in a string or a json object to stringify.\n*/\nexports.post = function(url, data, options) {\n\toptions = prepareData(data, options, 'POST');\n\n\treturn timeoutFetch(url, options);\n};\n\n/*\noptions:\ninit - init to pass through to fetch\n*/\nexports.put = function(url, data, options) {\n\toptions = prepareData(data, options, 'PUT');\n\n\treturn timeoutFetch(url, options);\n};\n\nexports.delete = function(url, options) {\n\toptions = checkDefaults(options, 'DELETE');\n\n\treturn timeoutFetch(url, options);\n};\n\nfunction timeoutFetch(url, options) {\n\treturn timeoutPromise(options.timeout || defaultTimeout, fetch(url, options.init)).then(function(response) {\n\t\tif (!response.ok) {\n\t\t\tthrow response;\n\t\t} else {\n\t\t\treturn response;\n\t\t}\n\t});\n}\n\nfunction checkCaches(url, options, callback) {\n\tif (!options.matchAll) {\n\t\tcaches\n\t\t\t.match(url)\n\t\t\t.then(handleResponse)\n\t\t\t.then(function(response) {\n\t\t\t\treturn handleCacheResponse(response, options, callback);\n\t\t\t})\n\t\t\t.catch(function(error) {\n\t\t\t\tconsole.log(error);\n\t\t\t});\n\t} else {\n\t\tcaches\n\t\t\t.match(url) //.matchAll(url)\n\t\t\t.then(handleResponse)\n\t\t\t.then(function(response) {\n\t\t\t\treturn handleCacheResponse(response, options, callback);\n\t\t\t})\n\t\t\t.catch(function(error) {\n\t\t\t\tconsole.log(error);\n\t\t\t});\n\t}\n}\n\nfunction prepareData(data, options, type) {\n\toptions = checkDefaults(options, type);\n\tif (isObject(data)) {\n\t\tdata = JSON.stringify(data);\n\t\toptions.init.headers = {\n\t\t\t'Content-type': 'application/json'\n\t\t};\n\t}\n\toptions.init.body = data;\n\treturn options;\n}\n\nfunction checkDefaults(options, type) {\n\tif (!options) options = {};\n\tif (!options.init) options.init = {};\n\tif (!options.init.method) options.init.method = type;\n\tif (!options.init.defaultCredentials) options = changeCredentials(options);\n\toptions = changeHeaders(options, type);\n\n\treturn options;\n}\n\nfunction changeHeaders(options, type) {\n\tconst header = {};\n\tObject.keys(defaultHeaders.ALL).forEach((key) => (header[key] = defaultHeaders.ALL[key]));\n\tObject.keys(defaultHeaders[type]).forEach((key) => (header[key] = defaultHeaders[type][key]));\n\tif (options.init.header)\n\t\tObject.keys(options.init.header).forEach((key) => (header[key] = options.init.header[key]));\n\n\tif (Object.keys(header).length > 0) {\n\t\toptions.init.headers = header;\n\t}\n\n\treturn options;\n}\n\nfunction changeCredentials(options) {\n\toptions.init.defaultCredentials = defaultCredentials;\n\treturn options;\n}\n\nfunction handleResponse(response) {\n\tif (!response) {\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\treject('No response');\n\t\t});\n\t} else if (!response.ok) {\n\t\tthrow response;\n\t} else {\n\t\treturn response;\n\t}\n}\n\nfunction handleNetworkResponse(response, options, callback) {\n\tif (!options.useCache) {\n\t\treturn handleResponseData(response, options);\n\t} else {\n\t\tif (!options.dataType) {\n\t\t\tif (options.handleNetworkResponse instanceof Function) options.handleNetworkResponse(response);\n\t\t\telse callback(response);\n\t\t} else {\n\t\t\tconsole.log(options.dataType);\n\t\t\thandleResponseData(response, options).then(function(data) {\n\t\t\t\tnetworkDataReceived = true;\n\t\t\t\tif (options.handleNetworkResponse instanceof Function) options.handleNetworkResponse(data);\n\t\t\t\telse callback(data); ///Implement object comparison?\n\t\t\t});\n\t\t}\n\t}\n}\n\nfunction handleCacheResponse(response, options, callback) {\n\t//Don't overwrite network data with cached data\n\tif (networkDataReceived) {\n\t\treturn;\n\t}\n\tif (!options.dataType) {\n\t\tif (options.handleCachedResponse instanceof Function) options.handleCachedResponse(response);\n\t\telse callback(response); ///Implement object comparison?\n\t} else {\n\t\treturn handleResponseData(response, options).then(function(data) {\n\t\t\tif (options.handleCachedResponse instanceof Function) options.handleCachedResponse(data);\n\t\t\telse callback(data); ///Implement object comparison?\n\t\t});\n\t}\n}\n\nfunction handleResponseData(response, options) {\n\tswitch (options.dataType) {\n\t\tcase 'json':\n\t\t\treturn response.json();\n\t\tcase 'blob':\n\t\t\treturn response.blob();\n\t\tcase 'arrayBuffer':\n\t\t\treturn response.arrayBuffer();\n\t\tcase 'formData':\n\t\t\treturn response.formData();\n\t\tcase 'text':\n\t\t\treturn response.text();\n\t\tdefault:\n\t\t\treturn response;\n\t}\n}\n\nfunction timeoutPromise(ms, promise) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst timeoutId = setTimeout(() => {\n\t\t\treject(new Error('Request Timeout'));\n\t\t}, ms);\n\t\tpromise.then(\n\t\t\t(res) => {\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\tresolve(res);\n\t\t\t},\n\t\t\t(err) => {\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\treject(err);\n\t\t\t}\n\t\t);\n\t});\n}\n\nfunction isObject(obj) {\n\treturn obj === Object(obj);\n}\n"],"sourceRoot":""}