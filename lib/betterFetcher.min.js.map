{"version":3,"sources":["webpack://betterFetcher/webpack/universalModuleDefinition","webpack://betterFetcher/webpack/bootstrap","webpack://betterFetcher/./src/better-fetcher.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","cacheName","defaultTimeout","defaultCredentials","defaultHeaders","GET","POST","PUT","DELETE","ALL","defaultDataType","networkDataReceived","timeoutFetch","url","options","timeoutPromise","timeout","fetch","init","then","response","ok","prepareData","data","type","obj","checkDefaults","JSON","stringify","body","headers","method","changeCredentials","header","Content-type","keys","forEach","length","changeHeaders","handleResponse","Promise","resolve","reject","handleCacheResponse","callback","dataType","handleResponseData","handleCachedResponse","Function","json","blob","arrayBuffer","formData","text","ms","promise","timeoutId","setTimeout","Error","res","clearTimeout","err","setCacheName","getCacheName","setDefaultTimeout","getDefaultTimeout","setDefaultCredentialsPolicy","getDefaultCredentialsPolicy","setDefaultHeaders","getDefaultHeaders","setDefaultDataType","getDefaultDataType","params","queryString","createQueryString","createUrl","networkCall","useCache","handleNetworkResponse","matchAll","caches","match","checkCaches","catch","post","put","delete"],"mappings":"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","file":"betterFetcher.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"betterFetcher\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"betterFetcher\"] = factory();\n\telse\n\t\troot[\"betterFetcher\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","var exports = (module.exports = {});\nvar cacheName = \"\";\nvar defaultTimeout = 5000;\nvar defaultCredentials = \"same-origin\";\nvar defaultHeaders = {\n  GET: {},\n  POST: {},\n  PUT: {},\n  DELETE: {},\n  ALL: {}\n};\nvar defaultDataType = \"\";\nvar networkDataReceived = false;\n\nexports.setCacheName = function(name) {\n  cacheName = name;\n};\n\nexports.getCacheName = function() {\n  return cacheName;\n};\n\nexports.setDefaultTimeout = function(ms) {\n  defaultTimeout = ms;\n};\n\nexports.getDefaultTimeout = function() {\n  return defaultTimeout;\n};\n\nexports.setDefaultCredentialsPolicy = function(mode) {\n  defaultCredentials = mode;\n};\n\nexports.getDefaultCredentialsPolicy = function() {\n  return defaultCredentials;\n};\n\nexports.setDefaultHeaders = function(headers, type) {\n  defaultHeaders[type] = headers;\n};\n\nexports.getDefaultHeaders = function(type) {\n  return defaultHeaders[type];\n};\n\nexports.setDefaultDataType = function(type) {\n  defaultDataType = type;\n};\n\nexports.getDefaultDataType = function() {\n  return defaultDataType;\n};\n\n/*\nurl:\nSet to the destination that you want to fetch data from.\noptions:\nmatchAll - Set flag true to match all responses in the cache instead of first hit\ndataType - Types include: \"json\", \"blob\", \"formData\", \"arrayBuffer\", \"text\", \"raw\"\ninit - Pass through init object to fetch call manually.\ntimeout - timeout (in ms) to set on the api call.\nhandleCachedResponse - Manually specify a function to be used only for returned cached data.\nhandleNetworkResponse - Manually specify a function to be used only for returned network data.\nuseCache - Flag to check cache and return\nparams - query parameters to pass in\ncallback:\nThe function to be called with data as it is received. Expect this function to be called multiple times given that it will likely first be called with cache data and then called with updated network data. \nDo not rely on it being called twice however given that it won't be called a second time if network data returns first or cache data does not exist\n*/\nexports.get = function(url, options = {}, callback) {\n  networkDataReceived = false;\n\n  options = checkDefaults(options, \"GET\");\n  url = createUrl(url, options);\n\n  // fetch fresh data\n  var networkCall = timeoutPromise(\n    options.timeout || defaultTimeout,\n    fetch(url, options.init)\n  )\n    .then(handleResponse)\n    .then(function(response) {\n      networkDataReceived = true;\n      return handleNetworkResponse(response, options, callback);\n    });\n\n  // fetch cached data\n  if (options.useCache)\n    checkCaches(url, options, callback).catch(function() {\n      //Don't throw error on cache miss since this is expected behavior\n    });\n\n  return networkCall;\n};\n\n/*\noptions:\ninit - init to pass through to fetch\nTakes in a string or a json object to stringify.\n*/\nexports.post = function(url, data, options) {\n  options = prepareData(data, options, \"POST\");\n\n  return timeoutFetch(url, options);\n};\n\n/*\noptions:\ninit - init to pass through to fetch\n*/\nexports.put = function(url, data, options) {\n  options = prepareData(data, options, \"PUT\");\n\n  return timeoutFetch(url, options);\n};\n\nexports.delete = function(url, options) {\n  options = checkDefaults(options, \"DELETE\");\n\n  return timeoutFetch(url, options);\n};\n\nfunction timeoutFetch(url, options) {\n  return timeoutPromise(\n    options.timeout || defaultTimeout,\n    fetch(url, options.init)\n  ).then(function(response) {\n    if (!response.ok) {\n      throw response;\n    } else {\n      return response;\n    }\n  });\n}\n\nfunction checkCaches(url, options, callback) {\n  if (!options.matchAll) {\n    return caches\n      .match(url)\n      .then(handleResponse)\n      .then(function(response) {\n        return handleCacheResponse(response, options, callback);\n      });\n  } else {\n    return caches\n      .match(url) //.matchAll(url)\n      .then(handleResponse)\n      .then(function(response) {\n        return handleCacheResponse(response, options, callback);\n      });\n  }\n}\n\nfunction prepareData(data, options, type) {\n  options = checkDefaults(options, type);\n  if (isObject(data)) {\n    data = JSON.stringify(data);\n  }\n  options.init.body = data;\n  return options;\n}\n\nfunction checkDefaults(options, type) {\n  if (!options) options = {};\n  if (!options.init) options.init = {};\n  if (!options.init.headers) options.init.headers = {};\n  if (!options.init.method) options.init.method = type;\n  if (!options.init.defaultCredentials) options = changeCredentials(options);\n  options = changeHeaders(options, type);\n\n  return options;\n}\n\nfunction changeHeaders(options, type) {\n  var header = {};\n  if (\n    !options.init.headers[\"Content-type\"] &&\n    (type === \"POST\" || type === \"PUT\")\n  ) {\n    header = {\n      \"Content-type\": \"application/json\"\n    };\n  }\n  Object.keys(defaultHeaders.ALL).forEach(\n    key => (header[key] = defaultHeaders.ALL[key])\n  );\n  Object.keys(defaultHeaders[type]).forEach(\n    key => (header[key] = defaultHeaders[type][key])\n  );\n  if (options.init.headers)\n    Object.keys(options.init.headers).forEach(\n      key => (header[key] = options.init.headers[key])\n    );\n\n  if (Object.keys(header).length > 0) {\n    options.init.headers = header;\n  }\n\n  return options;\n}\n\nfunction changeCredentials(options) {\n  options.init.defaultCredentials = defaultCredentials;\n  return options;\n}\n\nfunction handleResponse(response) {\n  if (!response) {\n    return new Promise(function(resolve, reject) {\n      reject(\"No response\");\n    });\n  } else if (!response.ok) {\n    throw response;\n  } else {\n    return response;\n  }\n}\n\nfunction handleNetworkResponse(response, options, callback) {\n  if (!options.useCache) {\n    return handleResponseData(response, options);\n  } else {\n    if (!options.dataType) {\n      if (options.handleNetworkResponse instanceof Function)\n        options.handleNetworkResponse(response);\n      else callback(response);\n    } else {\n      handleResponseData(response, options).then(function(data) {\n        networkDataReceived = true;\n        if (options.handleNetworkResponse instanceof Function)\n          options.handleNetworkResponse(data);\n        else callback(data); ///Implement object comparison?\n      });\n    }\n  }\n}\n\nfunction handleCacheResponse(response, options, callback) {\n  //Don't overwrite network data with cached data\n  if (networkDataReceived) {\n    return;\n  }\n  if (!options.dataType) {\n    if (options.handleCachedResponse instanceof Function)\n      options.handleCachedResponse(response);\n    else callback(response); ///Implement object comparison?\n  } else {\n    return handleResponseData(response, options).then(function(data) {\n      if (options.handleCachedResponse instanceof Function)\n        options.handleCachedResponse(data);\n      else callback(data); ///Implement object comparison?\n    });\n  }\n}\n\nfunction handleResponseData(response, options) {\n  switch (options.dataType) {\n    case \"json\":\n      return response.json();\n    case \"blob\":\n      return response.blob();\n    case \"arrayBuffer\":\n      return response.arrayBuffer();\n    case \"formData\":\n      return response.formData();\n    case \"text\":\n      return response.text();\n    default:\n      return response;\n  }\n}\n\nfunction createUrl(url, options) {\n\tif(options.params) {\n\t\tif(url[url.length-1] !== '/') {\n\t\t\turl = url + '/';\n\t\t}\n\t\turl = url + createQueryString(options.params);\n\t}\n\treturn url;\n}\n\nfunction createQueryString(params) {\n\tvar queryString = \"?\";\n\tvar keys = Object.keys(params);\n\tfor (var i = 0; i < keys.length; i++) {\n\t\tif (i !== keys.length - 1) queryString += params[keys[i]] + \"&\";\n\t\telse queryString += queryString += params[keys[i]];\n\t}\n\treturn queryString;\n}\n\nfunction timeoutPromise(ms, promise) {\n  return new Promise((resolve, reject) => {\n    const timeoutId = setTimeout(() => {\n      reject(new Error(\"Request Timeout\"));\n    }, ms);\n    promise.then(\n      res => {\n        clearTimeout(timeoutId);\n        resolve(res);\n      },\n      err => {\n        clearTimeout(timeoutId);\n        reject(err);\n      }\n    );\n  });\n}\n\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n"],"sourceRoot":""}